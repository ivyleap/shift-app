<script>
/* ❶ 権限判定 */
const isAdmin = new URLSearchParams(location.search).get('admin')==='1';

/* ❷ FullCalendar 初期化 部分に編集権限を反映 */
const calendar = new FullCalendar.Calendar(document.getElementById('calendar'),{
  locale:'ja',
  height:'auto',
  selectable:isAdmin,          // ←★
  selectMirror:true,
  selectLongPressDelay:0,
  unselectAuto:false,
  eventStartEditable:isAdmin,  // ←★
  eventDurationEditable:isAdmin, // ←★
  ...
  eventClick(info){
    if(info.event.extendedProps.locked && !isAdmin){
      alert('提出済みシフトは編集できません');  // 従業員は閲覧のみ
      return;
    }
    /* 管理者編集用ロジックをここに必要なら実装 */
  }
});

/* ❸ 保存時に locked フラグ */
document.getElementById('saveShift').onclick = ()=>{
  ...
  calendar.addEvent({
    title,
    start:dateStr,
    allDay:true,
    extendedProps:{s,e,st,locked:!isAdmin},
    editable:isAdmin
  });
  ...
};

/* ❹ 提出ボタンを従業員画面に追加したい場合 */
if(!isAdmin){
  const btn=document.createElement('button');
  btn.textContent='提出';
  btn.className='bg-green-600 text-white px-4 py-2 rounded';
  btn.onclick=()=>{
    calendar.getEvents().forEach(ev=>{
      ev.setExtendedProp('locked',true);
      ev.setProp('editable',false);
    });
    saveToStorage();
    alert('提出完了！');
  };
  document.body.prepend(btn);
}
</script>
